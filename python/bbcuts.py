import numpy as np
from matplotlib import pyplot as plt
from scipy import optimize as opt
from scipy import stats as sta

def plotit(cones,sig,bkg,base,rs,rb,lbl,linestyle):
	sum = base*(sig*rs + bkg*rb)
	print(sig*rs + bkg*rb)
	plt.plot(cones,sum,linestyle,label=lbl,linewidth=2)

cones = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]

#
# MuCo
# 
tev6sig = np.array([0.24259844782983617,0.24259844782983617,0.24259844782983617,0.2405863753952285,0.23713710836447255,0.23253808565679793,0.224777234837597,0.2170163840183961,0.20868065536073585,0.20149468237999424,0.19574590399540098,0.18741017533774074,0.17849956884162116,0.1701638401839609,0.16441506179936763,0.1566542109801667,0.15004311583788446,0.14429433745329118,0.1371083644725496,0.12819775797643002,0.11871227364185111])
tev6bkg = np.array([0.21938878769479864,0.21928759360453348,0.21746609997976118,0.21402550091074682,0.204715644606355,0.19358429467719085,0.18326249747014775,0.16980368346488564,0.15917830398704716,0.14602307225258046,0.13570127504553733,0.12699858328273628,0.11829589151993523,0.10868245294474803,0.10038453754300748,0.09461647439789517,0.08783647035013155,0.08277676583687513,0.07579437360858125,0.07194899817850638,0.06709168184578021])
tev6base = 2.034*0.333
tev6rs = 0.463
tev6rb = 0.532
lbl = "$6.0\ TeV$ MuCo"
plotit(cones,tev6sig,tev6bkg,tev6base,tev6rs,tev6rb,lbl,'r-')

#
# MuCo
# 
tev3sig = np.array([0.2763888888888889,0.2763888888888889,0.2761111111111111,0.2758333333333333,0.2738888888888889,0.2722222222222222,0.2688888888888889,0.26416666666666666,0.25916666666666666,0.2513888888888889,0.24388888888888888,0.23833333333333334,0.23083333333333333,0.2225,0.2136111111111111,0.2063888888888889,0.19833333333333333,0.18944444444444444,0.18333333333333332,0.17305555555555555,0.16472222222222221])
tev3bkg = np.array([0.25515985430999594,0.25515985430999594,0.2548563334682315,0.25323755564548767,0.24939295831647107,0.24504249291784702,0.23785916632942128,0.2281464993929583,0.2179279643868879,0.20781060299473897,0.19455685957102387,0.18413597733711048,0.17108458114123837,0.16076487252124647,0.15034399028733306,0.14133953864832052,0.13172804532577903,0.12322946175637393,0.11412383650343991,0.108559287737758,0.10076891946580332])
# Cross section times Br
tev3base = 0.849*0.333
# relative weight of 'signal' vs 'background'
tev3rs = 0.376
tev3rb = 0.609
lbl = "$3.0\ TeV$ MuCo"
plotit(cones,tev3sig,tev3bkg,tev3base,tev3rs,tev3rb,lbl,'g-')

#
# MuCo
# 
tev15sig = np.array([0.2912150598973189,0.2912150598973189,0.2912150598973189,0.29092983456930976,0.2903593839132915,0.2895037079292641,0.28864803194523675,0.2852253280091272,0.28237307472903594,0.2789503707929264,0.27438676554478036,0.26782658300057044,0.2629777524244153,0.25755847119224184,0.24957216200798632,0.2430119794637764,0.2358813462635482,0.2276098117512835,0.21620079863091843,0.20821448944666288,0.19880205362236167])
tev15bkg = np.array([0.2708860759493671,0.2708860759493671,0.2706835443037975,0.2700759493670886,0.2684556962025316,0.2668354430379747,0.26379746835443035,0.2603544303797468,0.25508860759493673,0.24951898734177216,0.24141772151898735,0.23443037974683545,0.22754430379746834,0.21670886075949367,0.20820253164556962,0.1972658227848101,0.1878481012658228,0.17832911392405063,0.16951898734177215,0.16131645569620254,0.1509873417721519])
tev15base = 0.233*0.333
tev15rs = 0.342
tev15rb = 0.611
lbl = "$1.5\ TeV$ MuCo"
plotit(cones,tev15sig,tev15bkg,tev15base,tev15rs,tev15rb,lbl,'b-')

#
# 6 TeV
#
# CLIC
# 
#tev6sig = np.array([0.2699051451566542,0.2699051451566542,0.2699051451566542,0.26703075596435755,0.2621442943374533,0.25467088243748204,0.24518539810290313,0.2359873526875539,0.226501868352975,0.2178787007760851,0.21069272779534348,0.2012072434607646,0.19143432020695603,0.18223627479160678,0.17562517964932453,0.16671457315320495,0.16010347801092267,0.15320494394941075,0.14659384880712847,0.13739580339177926,0.12704800229951135])
#tev6bkg = np.array([0.2546043311070634,0.25440194292653306,0.2515685083991095,0.24408014571949,0.23153207852661403,0.21655535316737504,0.2034001214329083,0.18720906699048775,0.17506577615867233,0.16019024488969844,0.1483505363286784,0.1377251568508399,0.12720097146326653,0.11687917425622343,0.10767051204209674,0.10089050799433313,0.09400930985630439,0.08824124671119207,0.08085407812183769,0.07650273224043716,0.07113944545638534])
#tev6base = 2.034*0.333
#tev6rs = 0.463
#tev6rb = 0.532
#lbl = "$6.0\ TeV$ CLIC"
#plotit(cones,tev6sig,tev6bkg,tev6base,tev6rs,tev6rb,lbl,'r--')

#
# 3 TeV
#
# CLIC
# 
tev3sig = np.array([0.30666666666666664,0.30666666666666664,0.3063888888888889,0.305,0.3013888888888889,0.29833333333333334,0.2936111111111111,0.28805555555555556,0.28194444444444444,0.27194444444444443,0.26166666666666666,0.25555555555555554,0.24638888888888888,0.23777777777777778,0.22833333333333333,0.22,0.2111111111111111,0.20166666666666666,0.1947222222222222,0.18416666666666667,0.17583333333333334])
tev3bkg = np.array([0.28439902873330636,0.28439902873330636,0.2837919870497774,0.2810602994738972,0.27579927154997974,0.2695265074868474,0.25991501416430596,0.24747065965196277,0.23502630513961958,0.22339133953864831,0.20932820720356132,0.19688385269121814,0.1830230675839741,0.17229866450829623,0.160461351679482,0.15115337919870497,0.1407324969647916,0.1320315661675435,0.12211655200323755,0.11564144071226225,0.10683933630109267])
# Cross section times Br
tev3base = 0.59*0.333
# relative weight of 'signal' vs 'background'
tev3rs = 0.376
tev3rb = 0.609
lbl = "$3.0\ TeV$ CLIC"
plotit(cones,tev3sig,tev3bkg,tev3base,tev3rs,tev3rb,lbl,'g--')

#
# 3 TeV
#
# CLIC
# 
tev15sig = np.array([0.3134626354820308,0.3134626354820308,0.3134626354820308,0.3131774101540217,0.3111808328579578,0.3103251568739304,0.30889903023388476,0.3051911009697661,0.3000570450656018,0.29606389047347403,0.2912150598973189,0.2837992013690816,0.27809469480889903,0.27296063890473476,0.26354820308043353,0.25613234455219624,0.2484312606959498,0.2401597261836851,0.22789503707929265,0.21990872789503707,0.20907016543069024])
tev15bkg = np.array([0.2995443037974684,0.2995443037974684,0.2991392405063291,0.29832911392405065,0.296,0.2931645569620253,0.2888101265822785,0.28354430379746837,0.27736708860759496,0.270379746835443,0.26116455696202534,0.25265822784810127,0.2449620253164557,0.23372151898734178,0.2249113924050633,0.2128607594936709,0.20253164556962025,0.19139240506329114,0.18136708860759493,0.17255696202531645,0.16141772151898734])
tev15base = 0.15*0.333
tev15rs = 0.342
tev15rb = 0.611
lbl = "$1.5\ TeV$ CLIC"
plotit(cones,tev15sig,tev15bkg,tev15base,tev15rs,tev15rb,lbl,'b--')


plt.grid(b='on',which='major',axis='both',alpha=0.9,aa=True)
plt.xlabel("Cone Angle (degrees)",fontsize=14)
plt.ylabel("$\sigma\ (fb)$       ",rotation='horizontal',fontsize=18)
plt.title("Effective cross section for two Higgs decaying to four b's\nvs. Cone Angle")

plt.legend()
plt.show()
